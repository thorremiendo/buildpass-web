<div *ngIf="!isLoading">

  <!--<div class="d-flex align-items-center" *ngIf="data.evaluator">
    <p class="m-0 p-0 mr-2" style="font-size: 12px">View All</p>
    <mat-slide-toggle
      [checked]="useDefault"
      (change)="toggle($event)"
    ></mat-slide-toggle>
  </div>-->

  <mat-form-field appearance="outline">
    <mat-label>Office</mat-label>
    <mat-select (selectionChange)="chooseOffice($event.value)">
        <mat-option value="1">CPDO</mat-option>
        <mat-option value="2">CEPMO</mat-option>
        <mat-option value="3">BFP</mat-option>
        <mat-option value="4">CBAO</mat-option>
    </mat-select>
  </mat-form-field>
  
  <table mat-table [dataSource]="revisionData" class="full-width" #revisionsTable>
    <ng-container matColumnDef="index"> 
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let item; let i = index">
        <mat-checkbox
          *ngIf="!item.label"
          [checked]="item.date_time_complied"
          [disabled]="officeId == 7"
          (change)="setRemarkCompliance(item.id, $event)"
        ></mat-checkbox>
      </td>
    </ng-container>

    <ng-container matColumnDef="remark">
      <th mat-header-cell *matHeaderCellDef>Remark</th>
      <td mat-cell *matCellDef="let item">
        <ng-container *ngIf="data.evaluatorRole; else applicant">
          <ng-container
            *ngIf="data.evaluatorRole.code !== 'CBAO-REC'; else receving"
          >
            <div *ngIf="item.label && item.label != 'current'">
              RETURNED TO APPLICANT
            </div>
            <div *ngIf="!item.label">
              {{ !item.label && item.remarks ? item.remarks : "Compliant" }}
            </div>
          </ng-container>
          <ng-template #receving>
            <div *ngIf="item.label && item.label != 'current'">
              RETURNED TO APPLICANT
            </div>
            <div *ngIf="!item.label">
              {{ !item.label && item.remarks ? item.remarks : "Submitted" }}
            </div>
          </ng-template>
        </ng-container>
        <ng-template #applicant>
          <div *ngIf="item.label && item.label != 'current'">
            {{ item.label | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
          </div>
          <div *ngIf="!item.label">
            {{ !item.label && item.remarks ? item.remarks : "Compliant" }}
          </div>
        </ng-template>
      </td>
    </ng-container>

    <ng-container matColumnDef="evaluator">
      <th mat-header-cell *matHeaderCellDef>Evaluated By</th>
      <td mat-cell *matCellDef="let item">
        {{ !item.label ? item.evaluator_detail.first_name + ' ' + item.evaluator_detail.last_name : '' }}
      </td>
    </ng-container>

    <ng-container matColumnDef="office">
      <th mat-header-cell *matHeaderCellDef>Office</th>
      <td mat-cell *matCellDef="let item">
        {{ !item.label ? getOfficeType(item.evaluator_detail.employee_detail.office_id) : '' }}
      </td>
    </ng-container>

    <ng-container matColumnDef="date_created">
      <th mat-header-cell *matHeaderCellDef>Date Created</th>
      <td mat-cell *matCellDef="let item">
        <div *ngIf="item.label">
          {{ item.label | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
        </div>
        <div *ngIf="!item.label">
          {{ item.created_at | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="date_complied">
      <th mat-header-cell *matHeaderCellDef>Date Completed</th>
      <td mat-cell *matCellDef="let item">
        <div *ngIf="!item.label">
          {{ item.date_time_complied | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr 
      mat-row 
      *matRowDef="let items; columns: displayedColumns" 
      [ngClass]="{'compliant': items.date_time_complied, 'label': items.label}"
    ></tr>
  </table>

  <!--<div *ngFor="let date of revisionLogs | keyvalue">
    {{ date.key | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
    <div *ngFor="let log of date.value" class="remark">
      <div>
        <mat-checkbox [checked]="log.date_time_complied" (change)="setRemarkCompliance(log.id, $event)"></mat-checkbox>
      </div>
      <div>
        {{ log.remarks }}
      </div>
      <div>
        {{ log.evaluator_detail.first_name }}&nbsp;
        {{ log.evaluator_detail.last_name }}
      </div>
      <div>
        {{ getOfficeType(log.evaluator_detail.employee_detail.office_id) }}
      </div>
      <div>
        {{ log.created_at | date: "MMMM dd, yyyy hh:mm:ss a":"+0800" }}
      </div>
    </div>
  </div>-->

  <form
    *ngIf="revisionData.length >= 1 && data.evaluator"
    [formGroup]="remarksForm"
  >
    <div class="mt-5">
      <div>
        <mat-form-field class="example-full-width">
          <mat-label>Add a Remark</mat-label>
          <input matInput formControlName="remarks" />
        </mat-form-field>
      </div>
      <div>
        <button
          mat-raised-button
          color="primary"
          type="button"
          (click)="addRemarks()"
        >
          Add a remark
        </button>
      </div>
    </div>
  </form>
  <div class="mt-5 text-right">
    <button mat-raised-button color="accent" (click)="onNoClick()">
      Close
    </button>
  </div> -->
</div>
